# üîÑ Hybrid AI Upgrade - AIAssistant Component

## üìã Co bylo zmƒõnƒõno

### Probl√©m
P≈Øvodn√≠ `AIAssistant` komponenta pou≈æ√≠vala pouze **GPT-4** (metoda `askAssistant`), co≈æ znamenalo:
- ‚ùå ≈Ω√°dn√© aktu√°ln√≠ informace z internetu
- ‚ùå ≈Ω√°dn√© zdroje a odkazy
- ‚ùå Odpovƒõdi zalo≈æen√© pouze na tr√©novac√≠ch datech GPT
- ‚ùå Nemo≈ænost naj√≠t aktu√°ln√≠ ceny, dodavatele, trendy

### ≈òe≈°en√≠
Upgradovali jsme `AIAssistant` komponentu na **Hybrid AI**:
- ‚úÖ Pou≈æ√≠v√° `askHybrid` metodu m√≠sto `askAssistant`
- ‚úÖ Inteligentn√≠ routing mezi GPT a Perplexity
- ‚úÖ Zobrazuje zdroje a odkazy
- ‚úÖ Provider badges (GPT / Perplexity / Hybrid)
- ‚úÖ Aktu√°ln√≠ informace z internetu

## üîß Technick√© zmƒõny

### 1. AIAssistant.tsx

#### Import AISourcesList
```typescript
import AISourcesList, { AIProviderBadge } from './AISourcesList'
```

#### P≈ôid√°n√≠ askHybrid do useAI hook
```typescript
const {
  loading,
  error,
  chatHistory,
  askAssistant,
  askHybrid,  // ‚Üê NOV√â
  getQuickSuggestions,
  clearError,
  clearChat
} = useAI()
```

#### Zmƒõna handleSendMessage
```typescript
// P≈òED:
await askAssistant(textToSend)

// PO:
await askHybrid(textToSend)  // ‚Üê Pou≈æ√≠v√° hybrid AI
```

#### Zobrazen√≠ zdroj≈Ø v chat history
```typescript
{chatHistory.map((msg) => (
  <div key={msg.id}>
    <div className="message-bubble">
      <p>{msg.content}</p>
      
      {/* Provider badge */}
      {msg.role === 'assistant' && msg.provider && (
        <AIProviderBadge provider={msg.provider} size="sm" />
      )}
    </div>
    
    {/* Sources */}
    {msg.role === 'assistant' && msg.sources && msg.sources.length > 0 && (
      <AISourcesList sources={msg.sources} compact={true} />
    )}
  </div>
))}
```

### 2. AISourcesList.tsx

#### P≈ôid√°n√≠ compact prop
```typescript
interface AISourcesListProps {
  sources?: AISource[]
  provider?: 'gpt' | 'perplexity' | 'hybrid'
  reasoning?: string
  className?: string
  compact?: boolean  // ‚Üê NOV√â
}
```

#### Compact mode logic
```typescript
export default function AISourcesList({ sources, compact = false, ... }) {
  // Use compact version if requested
  if (compact) {
    return <AISourcesCompact sources={sources} className={className} />
  }
  
  // ... full version
}
```

#### P≈ôesunut√≠ AISourcesCompact na zaƒç√°tek
```typescript
// P≈ôesunuto na zaƒç√°tek souboru, aby bylo dostupn√© v hlavn√≠ komponentƒõ
export function AISourcesCompact({ sources, className }) {
  return (
    <div className="flex items-center gap-2 flex-wrap">
      <span className="text-xs text-gray-500">Zdroje:</span>
      {sources.map((source, index) => (
        <a href={source.url} target="_blank" rel="noopener noreferrer">
          <span>{source.title}</span>
          <ExternalLink className="w-3 h-3" />
        </a>
      ))}
    </div>
  )
}
```

## üéØ Jak to funguje

### Query Analysis

Kdy≈æ u≈æivatel polo≈æ√≠ ot√°zku, `HybridAI` router analyzuje dotaz:

```typescript
// Real-time keywords
const realTimeKeywords = [
  'aktu√°ln√≠', 'souƒçasn√Ω', 'trendy', 'ceny', 'kolik stoj√≠',
  'najdi', 'hled√°m', 'doporuƒç', 'kde', 'kontakt'
]

// Personal keywords
const personalKeywords = [
  'moje', 'm≈Øj', 'na≈°e', 'n√°≈°', 'svatba',
  'host√©', 'rozpoƒçet', '√∫koly', 'timeline'
]

// Search keywords
const searchKeywords = [
  'fotograf', 'catering', 'm√≠sto', 'lokace', 'hotel',
  'kvƒõtiny', 'hudba', 'dj', 'kapela', '≈°aty'
]
```

### Routing Decision

```typescript
if (needsRealTimeData && needsExternalSources && !needsPersonalContext) {
  // ‚Üí Perplexity (pure search)
  queryType = 'search'
  
} else if (needsPersonalContext && !needsRealTimeData) {
  // ‚Üí GPT (personal data)
  queryType = 'personal'
  
} else if (needsRealTimeData || needsExternalSources) {
  // ‚Üí Hybrid (both)
  queryType = 'hybrid'
}
```

## üìä P≈ô√≠klady

### P≈ô√≠klad 1: Real-time dotaz (Perplexity)

**Input**:
```
"Kolik stoj√≠ fotograf v Praze?"
```

**Analysis**:
- ‚úÖ "kolik stoj√≠" ‚Üí real-time keyword
- ‚úÖ "fotograf" ‚Üí search keyword
- ‚ùå ≈Ω√°dn√© personal keywords

**Result**: ‚Üí **Perplexity**

**Output**:
```
Odpovƒõƒè: "Podle aktu√°ln√≠ch √∫daj≈Ø se ceny svatebn√≠ch fotograf≈Ø 
v Praze pohybuj√≠ mezi 15 000 - 50 000 Kƒç..."

Provider: perplexity
Badge: "Aktu√°ln√≠ informace z internetu"

Zdroje:
[1] Svatebn√≠ fotograf Praha - https://...
[2] Ceny fotograf≈Ø 2025 - https://...
```

### P≈ô√≠klad 2: Personal dotaz (GPT)

**Input**:
```
"Kolik mi zb√Ωv√° z rozpoƒçtu?"
```

**Analysis**:
- ‚úÖ "mi" ‚Üí personal keyword
- ‚úÖ "rozpoƒçet" ‚Üí personal keyword
- ‚ùå ≈Ω√°dn√© real-time keywords

**Result**: ‚Üí **GPT**

**Output**:
```
Odpovƒõƒè: "Z va≈°eho celkov√©ho rozpoƒçtu 300 000 Kƒç jste 
zat√≠m utratili 120 000 Kƒç. Zb√Ωv√° v√°m tedy 180 000 Kƒç..."

Provider: gpt
Badge: "AI"

Zdroje: (≈æ√°dn√© - personal data)
```

### P≈ô√≠klad 3: Hybrid dotaz (Both)

**Input**:
```
"Najdi mi ubytov√°n√≠ pro hosty na svatbu v okol√≠ na≈°√≠ svatby"
```

**Analysis**:
- ‚úÖ "najdi" ‚Üí real-time keyword
- ‚úÖ "ubytov√°n√≠" ‚Üí search keyword
- ‚úÖ "na≈°√≠ svatby" ‚Üí personal keyword

**Result**: ‚Üí **Hybrid**

**Output**:
```
Odpovƒõƒè: "V okol√≠ va≈°√≠ svatby v Praze jsem na≈°el tyto mo≈ænosti ubytov√°n√≠:

1. Hotel Ch√¢teau Mcely (10 pokoj≈Ø, 42 000 Kƒç) - ji≈æ rezervov√°no
2. Penzion U L√≠py (10 pokoj≈Ø) - ji≈æ rezervov√°no

Dal≈°√≠ doporuƒçen√© hotely v okol√≠:
- Hotel Grandior (od 2 500 Kƒç/noc)
- Hotel Majestic Plaza (od 3 200 Kƒç/noc)
- Penzion u ≈†√°rky (od 1 800 Kƒç/noc)"

Provider: hybrid
Badge: "Kombinace AI + aktu√°ln√≠ data"

Zdroje:
[1] Hotel Grandior - https://...
[2] Hotel Majestic Plaza - https://...
[3] Booking.com - Ubytov√°n√≠ Praha - https://...
```

## üé® UI Changes

### P≈ôed upgradem:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ User: Kolik stoj√≠ fotograf?         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AI: Ceny fotograf≈Ø se obvykle       ‚îÇ
‚îÇ pohybuj√≠ mezi 15-50 tis√≠c Kƒç...     ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ 20:19                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Po upgradu:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ User: Kolik stoj√≠ fotograf?         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AI: Podle aktu√°ln√≠ch √∫daj≈Ø se ceny  ‚îÇ
‚îÇ svatebn√≠ch fotograf≈Ø v Praze        ‚îÇ
‚îÇ pohybuj√≠ mezi 15 000 - 50 000 Kƒç... ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ 20:19    [üåê Real-time]             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Zdroje:                             ‚îÇ
‚îÇ [Svatebn√≠ fotograf Praha üîó]        ‚îÇ
‚îÇ [Ceny fotograf≈Ø 2025 üîó]            ‚îÇ
‚îÇ [Fotograf.cz üîó]                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## ‚úÖ Benefits

### Pro u≈æivatele:
- ‚úÖ **Aktu√°ln√≠ informace** - Real-time data z internetu
- ‚úÖ **Ovƒõ≈ôen√© zdroje** - Odkazy na origin√°ln√≠ zdroje
- ‚úÖ **Lep≈°√≠ odpovƒõdi** - Kombinace AI + aktu√°ln√≠ data
- ‚úÖ **Transparentnost** - Vid√≠, odkud informace poch√°z√≠

### Pro v√Ωvoj√°≈ôe:
- ‚úÖ **Jednoduch√° zmƒõna** - Jen zmƒõna z `askAssistant` na `askHybrid`
- ‚úÖ **Backward compatible** - Star√° metoda st√°le funguje
- ‚úÖ **Type safe** - Full TypeScript support
- ‚úÖ **Reusable** - Komponenty lze pou≈æ√≠t v≈°ude

## üß™ Testing

### Test 1: Real-time dotaz
```
1. Otev≈ôi aplikaci
2. Klikni na floating AI assistant
3. Napi≈°: "Kolik stoj√≠ fotograf v Praze?"
4. Ovƒõ≈ô:
   ‚úÖ Odpovƒõƒè obsahuje aktu√°ln√≠ ceny
   ‚úÖ Badge "Real-time" nebo "Hybrid AI"
   ‚úÖ Sekce "Zdroje" s odkazy
   ‚úÖ Odkazy jsou klikateln√©
```

### Test 2: Personal dotaz
```
1. Otev≈ôi aplikaci
2. Klikni na floating AI assistant
3. Napi≈°: "Kolik mi zb√Ωv√° z rozpoƒçtu?"
4. Ovƒõ≈ô:
   ‚úÖ Odpovƒõƒè obsahuje personal data
   ‚úÖ Badge "AI"
   ‚úÖ ≈Ω√°dn√© zdroje (expected)
```

### Test 3: Hybrid dotaz
```
1. Otev≈ôi aplikaci
2. Klikni na floating AI assistant
3. Napi≈°: "Najdi mi ubytov√°n√≠ pro hosty na svatbu v okol√≠ na≈°√≠ svatby"
4. Ovƒõ≈ô:
   ‚úÖ Odpovƒõƒè kombinuje personal data + real-time
   ‚úÖ Badge "Hybrid AI"
   ‚úÖ Sekce "Zdroje" s odkazy
   ‚úÖ Zm√≠nka o ji≈æ rezervovan√Ωch hotelech (personal)
   ‚úÖ Doporuƒçen√≠ nov√Ωch hotel≈Ø (real-time)
```

## üîÑ Migration Guide

### Pokud m√°≈° vlastn√≠ komponentu pou≈æ√≠vaj√≠c√≠ AIAssistant:

#### P≈ôed:
```typescript
import { useAI } from '@/hooks/useAI'

const { askAssistant } = useAI()
await askAssistant('Kolik stoj√≠ fotograf?')
```

#### Po:
```typescript
import { useAI } from '@/hooks/useAI'

const { askHybrid } = useAI()
const result = await askHybrid('Kolik stoj√≠ fotograf?')

// Display sources
if (result.sources && result.sources.length > 0) {
  <AISourcesList sources={result.sources} compact={true} />
}
```

## üìö Related Files

- `src/components/ai/AIAssistant.tsx` - Main chat component (upgraded)
- `src/components/ai/AISourcesList.tsx` - Sources display (upgraded)
- `src/hooks/useAI.ts` - AI hook with hybrid methods
- `src/lib/hybrid-ai.ts` - Hybrid AI router
- `src/lib/perplexity.ts` - Perplexity API client

## üéâ Summary

**AIAssistant komponenta je nyn√≠ plnƒõ hybrid!** üöÄ

- ‚úÖ Automaticky pou≈æ√≠v√° Perplexity pro real-time dotazy
- ‚úÖ Automaticky pou≈æ√≠v√° GPT pro personal dotazy
- ‚úÖ Automaticky kombinuje obƒõ pro hybrid dotazy
- ‚úÖ Zobrazuje zdroje a provider badges
- ‚úÖ ≈Ω√°dn√© breaking changes - star√° metoda st√°le funguje

**Tv≈Øj dotaz "Najdi mi ubytov√°n√≠ pro hosty na svatbu v okol√≠ na≈°√≠ svatby" nyn√≠ vr√°t√≠:**
- ‚úÖ Aktu√°ln√≠ hotely z internetu
- ‚úÖ Odkazy na booking str√°nky
- ‚úÖ Kombinaci s tv√Ωmi ji≈æ rezervovan√Ωmi hotely
- ‚úÖ Badge "Hybrid AI"

---

**Happy Coding!** ü§ñüîç

